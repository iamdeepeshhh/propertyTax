<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <title>Assessment Register - Combined Header</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari&display=swap" rel="stylesheet">
    <style>
        body {
          font-family: 'Noto Sans Devanagari', Arial, sans-serif;
          margin: 20px;
          font-size: 13px;
        }
        table {
          border-collapse: collapse;
          width: 100%;
        }
        th, td {
          border: 1px solid #000;
          text-align: center;
          padding: 5px;
        }
        th {
          font-weight: 600;
          vertical-align: middle;
        }
        .group { background: #e9f1ff; }

        /* vertical headers */
        .v {
          writing-mode: vertical-rl;
          transform: rotate(180deg);
          white-space: normal;
          word-break: break-word;
          font-size: 11px;
          line-height: 1.1;
          padding: 4px 2px;
          max-height: 100px;       /* gives the browser room to wrap vertically */
          height: 100px;           /* force wrapping */
          width: 30px;             /* narrower width forces breaks */
          overflow-wrap: break-word;
          overflow: hidden;
        }
        /* Split-print styling */
        th.p1, td.p1 { background: #e7f1ff; }
        th.p2, td.p2 { background: #e8f7e8; }

        .seam, td.seam, th.seam {
          width: 12px;
          min-width: 12px;
          background: repeating-linear-gradient(90deg,#999 0 1px, transparent 1px 12px);
          border-left: 0;
          border-right: 0;
        }

        .controls {
          position: sticky;
          top: 0;
          background: #fff;
          padding: 10px;
          display: flex;
          gap: 10px;
          z-index: 10;
          border-bottom: 1px solid #ccc;
        }
        button {
          background: #004aad;
          color: #fff;
          border: none;
          padding: 8px 14px;
          border-radius: 6px;
          cursor: pointer;
        }
        button.secondary { background: #0e7c3a; }

        .report-header {
            display: flex;
            align-items: center;
            justify-content: space-between; /* Aligns items to the left */
            margin-left: -10px; /* Shifts the entire header to the left by 10 pixels */
            padding: 10px 0; /* Adds padding on top and bottom */
        }

        .report-header img {
            height: 100px; /* Increased height */
            width: auto;  /* Auto width to maintain the aspect ratio */
            flex-shrink: 0; /* Prevents the logo from shrinking */
            margin-left: 120px; /* Maintains space between the logo and the text */
            border-radius: 20px;
            transform: scale(1.1);



        }

        .report-header div {
            flex-grow: 1; /* Allows the div to take up the remaining space */
            text-align: center; /* Centers the text inside the div */
            padding-left: 50px; /* Optional: Adjust if text needs to shift more to the center */
            overflow: hidden; /* Prevents text from overflowing */

        }

        .report-header h1, .report-header p {
            margin: 0; /* Removes any default margin */
            padding: 0; /* Ensures there are no paddings affecting the text */
            font-size: 22px;

        }

        .report-header h1 {
            color: red; /* set the color of header*/
            font-size: 22px; /* set the font size of header*/
        }
        /* PRINT visibility */
        @media print {
          .controls { display: none !important; }
          body.print1 .p2, body.print1 .seam { display: none !important; }
          body.print2 .p1, body.print2 .seam { display: none !important; }
        }
        @media print {
          thead { display: table-header-group !important; }
          tfoot { display: table-footer-group !important; }
        }


        @page { size: A3 landscape; margin: 1cm; }
    </style>
</head>

<body>
<div class="controls">
    <button onclick="printPart(1)">üñ®Ô∏è Print Part 1 (‡§∏‡•Å‡§®‡§æ‡§µ‡§£‡•Ä ‡§Ü‡§ß‡•Ä‡§ö‡•á ‡§™‡§∞‡•ç‡§Ø‡§Ç‡§§)</button>
    <button class="secondary" onclick="printPart(2)">üñ®Ô∏è Print Part 2 (‡§∏‡•Å‡§®‡§æ‡§µ‡§£‡•Ä ‡§®‡§Ç‡§§‡§∞‡§ö‡•á ‡§µ ‡§Ö‡§™‡•Ä‡§≤ ‡§®‡§Ç‡§§‡§∞)</button>
</div>

<header class="report-header">
    <img class="councilLogo" src="https://example.com/default-image.png" alt="Council Logo">
    <div>
        <h1 class="councilName">‡§®‡§ó‡§∞ ‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§, sitename / Nagar Panchayat sitename</h1>
        <p>(‡§®‡§Æ‡•Å‡§®‡§æ ‡•™‡•© ‡§®‡§ø‡§Ø‡§Æ ‡•≠‡•™ ‡§™‡§π‡§æ)/(Form No. 43 See Rule No. 74)</p>
        <p><span class="yearRange"></span> ‡§Ø‡§æ ‡§µ‡§∞‡•ç‡§∑‡§æ‡§Ç‡§∏‡§æ‡§†‡•Ä ‡§á‡§Æ‡§æ‡§∞‡§§‡•Ä ‡§µ ‡§ú‡§Æ‡•Ä‡§® ‡§Ø‡§æ‡§Ç‡§ö‡•Ä ‡§Ü‡§ï‡§æ‡§∞‡§£‡•Ä ‡§∏‡•Ç‡§ö‡•Ä</p>
    </div>
</header>
<table>
    <thead>
    <!-- üîπ Row 1 -->
    <tr>
        <!-- Left Half (Part 1) -->
        <th class="p1" rowspan="3">‡§ï‡•ç‡§∞.</th>
        <th class="p1" rowspan="3">‡§∞‡§∏‡•ç‡§§‡§æ,<br>‡§µ‡§ø‡§≠‡§æ‡§ó,<br>‡§Æ‡§Ç‡§°‡§≥‡§æ‡§ö‡•á ‡§®‡§æ‡§µ ‡§µ ‡§µ‡§æ‡§° ‡§ï‡•ç‡§∞.</th>
        <th class="p1" rowspan="3">‡§ù‡•ã‡§® ‡§ï‡•ç‡§∞.<br>(‡§®‡§µ‡•Ä‡§® / ‡§ú‡•Å‡§®‡§æ)</th>
        <th class="p1" rowspan="3">‡§Æ‡§æ‡§≤‡§Æ‡§§‡•ç‡§§‡§æ ‡§ï‡•ç‡§∞‡§Æ‡§æ‡§Ç‡§ï<br>(‡§®‡§µ‡•Ä‡§® / ‡§ú‡•Å‡§®‡§æ / ‡§∏‡§π. ‡§Æ‡§æ. ‡§®‡§Ç.)</th>
        <th class="p1" rowspan="3">‡§Æ‡§æ‡§≤‡§ï‡§æ‡§ö‡•á ‡§®‡§æ‡§µ</th>
        <th class="p1" rowspan="3">‡§≠‡•ã‡§ó‡§µ‡§ü‡§æ‡§¶‡§æ‡§∞‡§æ‡§ö‡•á ‡§®‡§æ‡§µ</th>
        <th class="p1 group" colspan="3">‡§Æ‡§æ‡§≤‡§Æ‡§§‡•ç‡§§‡•á‡§ö‡•á ‡§µ‡§∞‡•ç‡§£‡§®</th>
        <th class="p1 v" rowspan="3">‡§Æ‡§æ‡§≤‡§Æ‡§§‡•ç‡§§‡•á‡§ö‡•á ‡§Ö‡§Ç‡§¶‡§æ‡§ú‡§ø‡§§ ‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§≠‡§æ‡§°‡•á ‡§Æ‡•Ç‡§≤‡•ç‡§Ø</th>
        <th class="p1 v" rowspan="3">‡§≠‡§æ‡§°‡•ç‡§Ø‡§æ‡§®‡•á ‡§¶‡§ø‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ ‡§≠‡§æ‡§ó‡§æ‡§ö‡•á ‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§≠‡§æ‡§°‡•á</th>
        <th class="p1 v" rowspan="3">‡§≠‡§æ‡§°‡•ç‡§Ø‡§æ‡§®‡•á ‡§® ‡§¶‡§ø‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ ‡§≠‡§æ‡§ó‡§æ‡§ö‡•á ‡§Ö‡§Ç‡§¶‡§æ‡§ú‡§ø‡§§ ‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§≠‡§æ‡§°‡•á</th>
        <th class="p1 v" rowspan="3">‡§á‡§Æ‡§æ‡§∞‡§§‡•Ä‡§ö‡•á ‡§µ‡§æ ‡§ú‡§Æ‡§ø‡§®‡•Ä‡§ö‡•á ‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§≠‡§æ‡§°‡•á</th>
        <th class="p1 v" rowspan="3">‡§¶‡•Å‡§∞‡•Å‡§∏‡•ç‡§§‡•Ä ‡§á‡§§‡•ç‡§Ø‡§æ‡§¶‡•Ä ‡§∏‡§æ‡§†‡•Ä 10% ‡§µ‡§ú‡§æ‡§µ‡§ü</th>
        <th class="p1 v" rowspan="3">‡§á‡§Æ‡§æ‡§∞‡§§‡•Ä‡§ö‡•á ‡§µ‡§æ ‡§ú‡§Æ‡§ø‡§®‡•Ä‡§ö‡•á ‡§ï‡§∞‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§Æ‡•Ç‡§≤‡•ç‡§Ø</th>
        <th class="p1 group" colspan="9">‡§Ü‡§ï‡§æ‡§∞‡§£‡•ç‡§Ø‡§æ‡§§ ‡§Ü‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ ‡§ï‡§∞‡§æ‡§Ç‡§ö‡•Ä ‡§∞‡§ï‡•ç‡§ï‡§Æ (‡§∏‡•Å‡§®‡§æ‡§µ‡§£‡•Ä ‡§Ü‡§ß‡•Ä‡§ö‡•á)</th>

        <!-- seam -->
        <th class="seam" rowspan="3"></th>

        <!-- Right Half (Part 2) -->
        <th class="p2 group" colspan="9">‡§Ü‡§ï‡§æ‡§∞‡§£‡•ç‡§Ø‡§æ‡§§ ‡§Ø‡•á‡§£‡§æ‡§±‡•ç‡§Ø‡§æ ‡§ï‡§∞‡§æ‡§Ç‡§ö‡•Ä ‡§∞‡§ï‡•ç‡§ï‡§Æ (‡§Ü‡§ï‡•ç‡§∑‡•á‡§™ / ‡§∏‡•Å‡§®‡§æ‡§µ‡§£‡•Ä ‡§®‡§Ç‡§§‡§∞‡§ö‡•á)</th>
        <th class="p2 group" colspan="9">‡§Ü‡§ï‡§æ‡§∞‡§£‡•ç‡§Ø‡§æ‡§§ ‡§Ü‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ ‡§ï‡§∞‡§æ‡§Ç‡§ö‡•ç‡§Ø‡§æ ‡§∞‡§ï‡§Æ (‡§Ö‡§™‡•Ä‡§≤ ‡§®‡§Ç‡§§‡§∞)</th>
        <th class="p2" rowspan="3">‡§Ü‡§ï‡•ç‡§∑‡•á‡§™‡§æ‡§¨‡§æ‡§¨‡§§</th>
        <th class="p2" rowspan="3">‡§∏‡•Å‡§®‡§æ‡§µ‡§£‡•Ä ‡§®‡§ø‡§ï‡§æ‡§≤</th>
        <th class="p2" rowspan="3">‡§Ö‡§ß‡§ø‡§ï‡•É‡§§ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø ‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§£ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞‡•Ä‡§ö‡•Ä ‡§∏‡§π‡•Ä</th>
        <th class="p2" rowspan="3">‡§Ö‡§™‡•Ä‡§≤ ‡§∏‡§Æ‡§ø‡§§‡•Ä ‡§∏‡§≠‡§æ‡§™‡§§‡•Ä‡§ö‡•Ä ‡§∏‡§π‡•Ä</th>
        <th class="p2" rowspan="3">‡§´‡•á‡§∞‡§´‡§æ‡§∞ ‡§¨‡§Å‡§≤‡§ö‡§æ ‡§∂‡•á‡§∞‡§æ ‡§µ ‡§Æ‡•Å‡§ñ‡•ç‡§Ø‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞‡•Ä ‡§Ø‡§æ‡§Ç‡§ö‡•Ä ‡§∏‡§π‡•Ä</th>
        <th class="p2 v" rowspan="3">‡§µ‡§æ‡§™‡§∞ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ / ‡§Æ‡§ú‡§≤‡§æ / ‡§Æ‡§æ‡§≤‡§ï, ‡§≠‡§æ‡§°‡•á‡§ï‡§∞‡•Ç</th>
    </tr>

    <!-- üîπ Row 2 -->
    <tr>
        <!-- Description -->
        <th class="p1 v">‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ / ‡§Æ‡§ú‡§≤‡§æ / ‡§Æ‡§æ‡§≤‡§ï / ‡§≠‡§æ‡§°‡•á‡§ï‡§∞‡•Ç</th>
        <th class="p1 v">‡§¨‡§æ‡§Ç‡§ß‡§ï‡§æ‡§Æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ / ‡§ï‡§∞‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡§´‡§≥</th>
        <th class="p1 v">‡§è‡§ï‡•Ç‡§£ ‡§ï‡§∞‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡§´‡§≥</th>

        <!-- Taxes (‡§∏‡•Å‡§®‡§æ‡§µ‡§£‡•Ä ‡§Ü‡§ß‡•Ä‡§ö‡•á) -->
        <th class="p1">‡§ï‡§∞‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§Æ‡•Ç‡§≤‡•ç‡§Ø</th>
        <th class="p1">‡§Æ‡§æ‡§≤‡§Æ‡§§‡•ç‡§§‡§æ ‡§ï‡§∞</th>
        <th class="p1 v">‡§∏‡•ç‡§µ‡§ö‡•ç‡§õ‡§§‡§æ ‡§ï‡§∞</th>
        <th class="p1 v">‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ï‡§∞</th>
        <th class="p1 v">‡§Ö‡§ó‡•ç‡§®‡§ø‡§∂‡§Æ‡§® ‡§ï‡§∞</th>
        <th class="p1 v">‡§ù‡§æ‡§° ‡§ï‡§∞</th>
        <th class="p1 v">‡§™‡§∞‡•ç‡§Ø‡§æ‡§µ‡§∞‡§£ ‡§ï‡§∞</th>
        <th class="p1 v">‡§∞‡•ã‡§ú‡§ó‡§æ‡§∞ ‡§π‡§Æ‡•Ä ‡§∏‡•á‡§∏</th>
        <th class="p1">‡§è‡§ï‡•Ç‡§£</th>

        <!-- Taxes (‡§∏‡•Å‡§®‡§æ‡§µ‡§£‡•Ä ‡§®‡§Ç‡§§‡§∞‡§ö‡•á) -->
        <th class="p2">‡§ï‡§∞‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§Æ‡•Ç‡§≤‡•ç‡§Ø</th>
        <th class="p2">‡§Æ‡§æ‡§≤‡§Æ‡§§‡•ç‡§§‡§æ ‡§ï‡§∞</th>
        <th class="p2 v">‡§∏‡•ç‡§µ‡§ö‡•ç‡§õ‡§§‡§æ ‡§ï‡§∞</th>
        <th class="p2 v">‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ï‡§∞</th>
        <th class="p2 v">‡§Ö‡§ó‡•ç‡§®‡§ø‡§∂‡§Æ‡§® ‡§ï‡§∞</th>
        <th class="p2 v">‡§ù‡§æ‡§° ‡§ï‡§∞</th>
        <th class="p2 v">‡§™‡§∞‡•ç‡§Ø‡§æ‡§µ‡§∞‡§£ ‡§ï‡§∞</th>
        <th class="p2 v">‡§∞‡•ã‡§ú‡§ó‡§æ‡§∞ ‡§π‡§Æ‡•Ä ‡§∏‡•á‡§∏</th>
        <th class="p2">‡§è‡§ï‡•Ç‡§£</th>

        <!-- Taxes (‡§Ö‡§™‡•Ä‡§≤ ‡§®‡§Ç‡§§‡§∞) -->
        <th class="p2">‡§ï‡§∞‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§Æ‡•Ç‡§≤‡•ç‡§Ø</th>
        <th class="p2">‡§Æ‡§æ‡§≤‡§Æ‡§§‡•ç‡§§‡§æ ‡§ï‡§∞</th>
        <th class="p2 v">‡§∏‡•ç‡§µ‡§ö‡•ç‡§õ‡§§‡§æ ‡§ï‡§∞</th>
        <th class="p2 v">‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ï‡§∞</th>
        <th class="p2 v">‡§Ö‡§ó‡•ç‡§®‡§ø‡§∂‡§Æ‡§® ‡§ï‡§∞</th>
        <th class="p2 v">‡§ù‡§æ‡§° ‡§ï‡§∞</th>
        <th class="p2 v">‡§™‡§∞‡•ç‡§Ø‡§æ‡§µ‡§∞‡§£ ‡§ï‡§∞</th>
        <th class="p2 v">‡§∞‡•ã‡§ú‡§ó‡§æ‡§∞ ‡§π‡§Æ‡•Ä ‡§∏‡•á‡§∏</th>
        <th class="p2">‡§è‡§ï‡•Ç‡§£</th>
    </tr>
    </thead>

    <tbody>
    <!-- Example row -->
    <tr>
        <td class="p1">1</td>
        <td class="p1">‡§ó‡§æ‡§Ç‡§ß‡•Ä ‡§ö‡•å‡§ï</td>
        <td class="p1">3</td>
        <td class="p1">020001</td>
        <td class="p1">‡§∂‡•ç‡§∞‡•Ä. ‡§∞‡§æ‡§Æ ‡§™‡§æ‡§ü‡•Ä‡§≤</td>
        <td class="p1">‡§∏‡•ç‡§µ‡§§‡§É</td>
        <td class="p1">G</td>
        <td class="p1">‡§Ü‡§∞.‡§∏‡•Ä.‡§∏‡•Ä.</td>
        <td class="p1">100</td>
        <td class="p1">2000</td>
        <td class="p1">500</td>
        <td class="p1">400</td>
        <td class="p1">360</td>
        <td class="p1">36</td>
        <td class="p1">324</td>
        <td class="p1">100</td><td class="p1">50</td><td class="p1">20</td><td class="p1">10</td><td class="p1">5</td><td class="p1">10</td><td class="p1">5</td><td class="p1">4</td><td class="p1">204</td>

        <td class="seam"></td>

        <td class="p2">120</td><td class="p2">60</td><td class="p2">20</td><td class="p2">10</td><td class="p2">5</td><td class="p2">10</td><td class="p2">5</td><td class="p2">4</td><td class="p2">234</td>
        <td class="p2">130</td><td class="p2">70</td><td class="p2">30</td><td class="p2">15</td><td class="p2">5</td><td class="p2">15</td><td class="p2">5</td><td class="p2">4</td><td class="p2">274</td>
        <td class="p2">‡§®‡§æ‡§π‡•Ä</td>
        <td class="p2">‡§™‡•Ç‡§∞‡•ç‡§£</td>
        <td class="p2">‚úîÔ∏è</td>
        <td class="p2">‚úîÔ∏è</td>
        <td class="p2">‚úîÔ∏è</td>
        <td class="p2">‡§µ‡•ç‡§Ø‡§æ‡§µ‡§∏‡§æ‡§Ø‡§ø‡§ï</td>
    </tr>
    </tbody>
</table>

<script>
    document.addEventListener("DOMContentLoaded", () => {
      const wardNo = new URLSearchParams(window.location.search).get("wardNo") || 1;
      const tbody = document.querySelector("tbody");
      const yearRange = document.querySelector(".yearRange");

      // Example: dynamically set year range
      const currentYear = new Date().getFullYear();
      yearRange.textContent = `${currentYear - 1}-${currentYear}`;

      fetch(`/3g/secondaryBatchAssessmentReport?wardNo=${wardNo}`)
        .then(res => {
          if (!res.ok) throw new Error(`HTTP ${res.status}`);
          return res.json();
        })
        .then(data => {
          if (!data || data.length === 0) {
            tbody.innerHTML = `<tr><td colspan="40">No records found for ward ${wardNo}</td></tr>`;
            return;
          }
          renderAssessmentTable(data);
        })
        .catch(err => {
          console.error("‚ùå Error fetching report:", err);
          tbody.innerHTML = `<tr><td colspan="40">Error loading report: ${err.message}</td></tr>`;
        });
    });

    // -------------------------- //
    // üîπ RENDERING MAIN FUNCTION //
    // -------------------------- //
    function renderAssessmentTable(data) {
      const tbody = document.querySelector("tbody");
      tbody.innerHTML = "";

      const grouped = data.reduce((acc, prop) => {
  const key = prop.propertyDetails?.pdNewpropertynoVc;
  if (!acc[key]) acc[key] = [];
  acc[key].push(prop);
  return acc;
}, {});

let index = 0;

// üîπ Render one row per property (with merged units)
Object.values(grouped).forEach(group => {
  index++;
  const property = group[0];
  const pd = property.propertyDetails || {};
  const units = group.flatMap(p => p.propertyUnitDetails || []);

  // merge unit-level fields
  const floorNos = units.map(u => u.floorNoVc || "").join("<br>");
  const constTypes = units.map(u => u.constructionTypeVc || "").join("<br>");
  const areas = units.map(u => u.taxableAreaFl || "").join("<br>");
  const usages = units.map(u => u.usageTypeVc || "").join("<br>");
  const totalArea = units.reduce((sum, u) => sum + (parseFloat(u.taxableAreaFl) || 0), 0);

  // combine taxes
  const beforeAll = group.map(p => p.taxKeyValueMapAfterAssess || {});
  const afterAll = group.map(p => p.taxKeyValueMapAfterHearing || {});
  const mergeTaxMaps = (arr) => {
    const total = {};
    arr.forEach(m => {
      for (const [k, v] of Object.entries(m)) {
        total[k] = (total[k] || 0) + (parseFloat(v) || 0);
      }
    });
    return total;
  };
  const before = mergeTaxMaps(beforeAll);
  const after = mergeTaxMaps(afterAll);

  const totalBefore = Object.values(before).reduce((a, b) => a + b, 0);
  const totalAfter = Object.values(after).reduce((a, b) => a + b, 0);

  const row = document.createElement("tr");
  row.innerHTML = `
    <td class="p1">${index}</td>
    <td class="p1">${pd.pdWardI || ""}</td>
    <td class="p1">${pd.pdZoneI || ""}</td>
    <td class="p1">${pd.pdNewpropertynoVc || ""}<br>${pd.pdFinalpropnoVc || ""}</td>
    <td class="p1">${pd.pdOwnernameVc || "‚Äî"}</td>
    <td class="p1">${pd.pdOccupinameF || "‚Äî"}</td>
    <td class="p1">${floorNos}</td>
    <td class="p1">${constTypes}</td>
    <td class="p1">${areas}<hr><b>${totalArea.toFixed(2)}</b></td>

    <td class="p1">${before["ratepersqm"] || ""}</td>
    <td class="p1">${before["actualrent"] || ""}</td>
    <td class="p1">${before["ratablevalue"] || ""}</td>
    <td class="p1">${before["amountafterdep"] || ""}</td>
    <td class="p1">${before["depamount"] || ""}</td>
    <td class="p1">${before["totalratablevalue"] || ""}</td>

    <td class="p1">${before["1"] || 0}</td>
    <td class="p1">${before["3"] || 0}</td>
    <td class="p1">${before["4"] || 0}</td>
    <td class="p1">${before["5"] || 0}</td>
    <td class="p1">${before["6"] || 0}</td>
    <td class="p1">${before["7"] || 0}</td>
    <td class="p1">${before["27"] || 0}</td>
    <td class="p1">${before["46"] || 0}</td>
    <td class="p1"><b>${totalBefore.toFixed(0)}</b></td>

    <td class="seam"></td>

    <td class="p2">${after["taxableValueConsideredFl"] || ""}</td>
    <td class="p2">${after["1"] || 0}</td>
    <td class="p2">${after["3"] || 0}</td>
    <td class="p2">${after["4"] || 0}</td>
    <td class="p2">${after["5"] || 0}</td>
    <td class="p2">${after["6"] || 0}</td>
    <td class="p2">${after["7"] || 0}</td>
    <td class="p2">${after["27"] || 0}</td>
    <td class="p2">${after["46"] || 0}</td>
    <td class="p2"><b>${totalAfter.toFixed(0)}</b></td>

    <td class="p2">‚Äî</td>
    <td class="p2">‚Äî</td>
    <td class="p2">‚úîÔ∏è</td>
    <td class="p2">‚úîÔ∏è</td>
    <td class="p2">‚úîÔ∏è</td>
    <td class="p2">${usages}</td>
  `;

  tbody.appendChild(row);
});
    }
    function printPart(part) {
      document.body.classList.remove('print1','print2');
      document.body.classList.add(part === 1 ? 'print1' : 'print2');
      window.print();
      setTimeout(() => document.body.classList.remove('print1','print2'), 400);
    }
</script>
</body>
</html>
